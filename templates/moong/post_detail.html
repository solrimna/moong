<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }}</title>
    <style>

    </style>
</head>

<body>
    <div class="post-container">
        <div class="post-header">
            <h4 style="margin: 5px 0;">
            <a href="{% url 'moong:post_detail' post.id %}">
                {{ post.title }}
            </a> 
            </h4>
            <div style="color: #666; font-size: 14px;">
                ì‘ì„±ì: {{ post.author.username }} | {{ post.create_time }}
            </div>
        </div>
        
        <div class="post-content">
            {{ post.content }}
        </div>
        <div class="post-images">
        {% for image in post.images.all %}
            <img src="{{ image.image.url }}" alt="{{ post.title }}" style="max-width: 100%; margin: 10px 0;">
        {% endfor %}
        </div>
        <div class="post-info">
            <div>
                <strong>ğŸ“… ëª¨ì„ ë‚ ì§œ:</strong> 
                {{ post.moim_date }} {{ post.moim_time }}
            </div>
            <div>
                <strong>ğŸ“ ëª¨ì„ ì¥ì†Œ:</strong>
                {% if post.location %}
                    {{ post.location.sido }} {{ post.location.sigungu }} {{ post.location.eupmyeondong }}
                {% else %}
                    ì¥ì†Œ ë¯¸ì •
                {% endif %}
            </div>
            <div>
                {% if request.user.is_authenticated %}
                    {% if is_applied %}
                        <form action="{% url 'moong:post_cancel' post.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit" clsss="btn btn-danger">ì°¸ì—¬ ì·¨ì†Œí•˜ê¸°</button>
                        </form>
                    {% else %}
                        <form action="{% url 'moong:post_apply' post.id %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-primary" {% if post.is_full %}disabled{% endif %}>
                                {% if post.is_full %}ì •ì› ì´ˆê³¼{% else %}ì°¸ì—¬ ì‹ ì²­í•˜ê¸°{% endif %}
                            </button>
                        </form>
                    {% endif %}
                {% endif %}
            </div>

            <div class="info-box">
                <span>ì°¸ì—¬ í˜„í™©: <strong>{{ post.get_approved_count }}</strong> / {{ post.max_people }}ëª…</span>
                {% if post.is_full %}
                    <span style="color: red; font-weight: bold;">[ë§ˆê°]</span>
                {% endif %}
            </div>
            {% if post.max_people %}
                <div>
                    <strong>ğŸ‘¥ ìµœëŒ€ ì¸ì›:</strong> 
                    {{ post.max_people }}ëª…
                </div>
            {% endif %}
        </div>
        
        <div class="post-tags" style="margin-top: 10px;">
            {% for tag in post.hashtags.all %}
                <a href="{% url 'moong:tag_feeds' tag.name %}" style="text-decoration: none; color: #007bff; font-size: 0.9rem;">#{{ tag.name }}</a>
            {% endfor %}
        </div>

        <hr style="border: 0; border-top: 1px solid #eee; margin: 15px 0;">

        <div class="post-comments" style="font-size: 1.3rem;">
            <h6>ëŒ“ê¸€ {{ post.comments.count }}ê°œ</h6>
            {% for comment in post.comments.all %}
                <div style="margin-bottom: 5px;">
                    <strong>{{ comment.author.nick_name }}</strong> {{ comment.content }}
                </div>
            {% endfor %}
        </div>

        <div class="button-group">
            <a href="{% url 'moong:main' %}" class="btn btn-secondary">ëª©ë¡ìœ¼ë¡œ</a>
            {% if user == post.author %}
                <a href="{% url 'moong:post_mod' post.id %}" class="btn btn-primary"> ìˆ˜ì •</a>
            {% endif %}
        </div>
    </div>
</body>
</html>
